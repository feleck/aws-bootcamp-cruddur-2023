#!/usr/bin/env bash

set -e # stop the execution if it fails


ABS_PATH=$(readlink -f "$0")
BACKEND_PATH=$(dirname $ABS_PATH)
BIN_PATH=$(dirname $BACKEND_PATH)
PROJECT_PATH=$(dirname $BIN_PATH)
# BACKEND_FLASK_PATH="$PROJECT_PATH/backend-flask"
CFN_PATH="$PROJECT_PATH/aws/cfn"
echo $CFN_PATH

cfn-lint "$CFN_PATH/template.yaml"

aws cloudformation deploy \
    --stack-name "my-cluster" \
    --template-file  "$CFN_PATH/template.yaml" \
    --no-execute-changeset \
    --capabilities CAPABILITY_NAMED_IAM
